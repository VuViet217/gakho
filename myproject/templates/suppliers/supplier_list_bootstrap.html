{% extends 'suppliers/supplier_base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block actions %}
<a href="{% url 'supplier_create' %}" class="btn btn-primary">
    <i class="bi bi-plus"></i> Thêm nhà cung cấp
</a>
{% endblock %}

{% block supplier_content %}
<div class="row mb-4">
    <div class="col-md-6">
        <form action="{% url 'supplier_list' %}" method="GET" class="d-flex">
            <div class="input-group">
                <input type="text" name="search" class="form-control" placeholder="Tìm kiếm nhà cung cấp..." value="{{ search_query }}">
                <button class="btn btn-outline-secondary" type="submit">
                    <i class="bi bi-search"></i>
                </button>
                {% if search_query %}
                <a href="{% url 'supplier_list' %}" class="btn btn-outline-danger">
                    <i class="bi bi-x"></i>
                </a>
                {% endif %}
            </div>
        </form>
    </div>
</div>

<div class="table-responsive">
    <table class="table table-bordered table-hover table-striped">
        <thead>
            <tr>
                <th>Mã NCC</th>
                <th>Tên nhà cung cấp</th>
                <th>Người liên hệ</th>
                <th>Số điện thoại</th>
                <th>Email</th>
                <th>Thao tác</th>
            </tr>
        </thead>
        <tbody>
            {% for supplier in page_obj %}
            <tr>
                <td>{{ supplier.code }}</td>
                <td><a href="{% url 'supplier_detail' supplier.id %}">{{ supplier.name }}</a></td>
                <td>{{ supplier.contact_name }}</td>
                <td>{{ supplier.contact_phone }}</td>
                <td>{{ supplier.contact_email|default:"-" }}</td>
                <td>
                    <div class="btn-group">
                        <a href="{% url 'supplier_detail' supplier.id %}" class="btn btn-sm btn-info" title="Xem chi tiết">
                            <i class="bi bi-eye"></i>
                        </a>
                        <a href="{% url 'supplier_update' supplier.id %}" class="btn btn-sm btn-primary" title="Chỉnh sửa">
                            <i class="bi bi-pencil"></i>
                        </a>
                        <a href="{% url 'supplier_delete' supplier.id %}" class="btn btn-sm btn-danger" title="Xóa">
                            <i class="bi bi-trash"></i>
                        </a>
                    </div>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" class="text-center">Không có nhà cung cấp nào.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% if page_obj.paginator.num_pages > 1 %}
<div class="pagination justify-content-center mt-4">
    <ul class="pagination">
        {% if page_obj.has_previous %}
        <li class="page-item">
            <a class="page-link" href="?page=1{% if search_query %}&search={{ search_query }}{% endif %}">&laquo; Đầu</a>
        </li>
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}">Trước</a>
        </li>
        {% endif %}
        
        {% for num in page_obj.paginator.page_range %}
        {% if page_obj.number == num %}
        <li class="page-item active">
            <a class="page-link" href="#">{{ num }}</a>
        </li>
        {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
        <li class="page-item">
            <a class="page-link" href="?page={{ num }}{% if search_query %}&search={{ search_query }}{% endif %}">{{ num }}</a>
        </li>
        {% endif %}
        {% endfor %}
        
        {% if page_obj.has_next %}
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}">Tiếp</a>
        </li>
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}{% if search_query %}&search={{ search_query }}{% endif %}">Cuối &raquo;</a>
        </li>
        {% endif %}
    </ul>
</div>
{% endif %}
{% endblock %}